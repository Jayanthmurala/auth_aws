# Auth Service Environment
PORT=4001
NODE_ENV=development

# Database (Postgres) - replace with your database URL
# For production, add connection pooling parameters:
# DATABASE_URL="postgresql://username:password@host:5432/database?schema=authsvc&connection_limit=100&pool_timeout=10&connect_timeout=5"

# Database Connection Pool Configuration (for production scale)
DB_CONNECTION_LIMIT=100
DB_POOL_TIMEOUT=10000
DB_CONNECTION_TIMEOUT=5000

# Database Read Replicas (comma-separated URLs for horizontal scaling)
# DATABASE_READ_REPLICAS="postgresql://user:pass@replica1:5432/db?schema=authsvc,postgresql://user:pass@replica2:5432/db?schema=authsvc"

# JWT (RS256) - Generate with: npm run generate-keys
DATABASE_URL=postgresql://neondb_owner:npg_UCcef8wWmz4x@ep-long-band-ab8cs616-pooler.eu-west-2.aws.neon.tech/neondb?sslmode=require&schema=authsvc
# JWT (RS257)
AUTH_JWT_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\nMIIEuwIBADANBgkqhkiG9w0BAQEFAASCBKUwggShAgEAAoIBAQCrN5ZKuWIWWhhq\n3OJzkYCusC0+X9FaCTUJQlaa86Rzx2kM3FnCXnTwEGylLRXBVhOKgG5RQSu4cYmA\nCTWljqRum7wv0X9C6pPzo9pGtWsHZb1yRcyRctg0aWNhK4QZDTtPtdrg4OHurdiq\nSmoCrk88NAQfj0pf8fndMkTL/D+BJa4fbX5WHF0B32znj+YYCXnBGwNOw19/rEl1\nnMsAl7ziyrjPCORol7SyFEJEBcjgU6PZ1R9SN8oo/Qf4BYoj4Ax0PlCubNOsOibK\nTfPh7DUjLjACqadvQJAOo8tIb/G+CY7L6Mzd5X8W1w2UmvyMSfnnuLIC4rjxlTmG\nrCKqSm1zAgMBAAECgf8CdcErr9Z1Q9kQFAq3LowjaSbNch1JS05Fvy+6NlkR764a\nEWLO1PxpUFSRrNB6AmpROtabqZe5bNl4TOpPNealb3QStHRF4vWeVZA0R7xWiBD4\n1wTzKZLi8wqdzYyOB39UIXH06Yzc0lMqPJ3oNAuxmdXQjJyoQsX+7vTQS945qmJu\nFpkNeVBWVtClsGbcSByptsHjgMh0Lvo1gjmaevKUy/BfurOJau50NFVKu1IpC0PI\nDjrm3Dj8fJ3wjWIXAlH4QPZNTbPReGTwAPDAoAhzApOM1rtgDNyFcyjg3V25cWf4\nKtw1g5YT6X0nnXY0Y5izXEhAg8YKE4WBuj2PEAECgYEA5ClaC+00FhNiwiTvdL+q\nEiZ/KXZieL0wR63GoG8pZf5CPBhd+YUJoMLR0k5sgfmP3GshlCTqotPpIARqCwKy\nwM/pXXnkLaxlH/lEFutokdqPM+yIcJrpSj9s8+1mvaYdCfttaohSIA/dIfLIsCeZ\nC6S3rCLryR07IwlNvQbv1mECgYEAwBuSTjPp+OA+EU+KoX8zuQ66mLSm81wDmA+b\nKF0kyc/vez3BrfgSSatm2wN7bAPDyseavVfQftCBHxI6oNXgwR38F7oLix/P1aIj\n9SMmkhs5M37VlLxNNG5Z2ILwL+RpCOlc2CHua3BLR8gvZCPgXzhmNz7lJ6oAprZv\n/bV3bFMCgYEAtOXYYCZkqrAaGCXiuSUReayOG9iiAGq3sc0k86TPJO+voigLsj75\nwD1W0LCfNXohxrgl+mg+pHTxnBID5dDw2xC9TQDMmi3aS7x9cNKaqTGpYpjCIM2h\n891PzCLI18qxsW1odhO5UXRidn0hAxGSNXoWqmNRoLYNYh0JRrsOQ2ECgYAYLiA/\nOaeUjN0jHqjrZPBktabk+7Ab55QIOsaj0P2FbWfOUlqjhBsBLNLYdFq/oMWvK2qd\ntITowWPPPmMkxWbxx81oSyGS1GE7mZn/C/qZ31VW1vsZKo5pMA6dAvYqgQx7c6wd\nBEBXQ54mHdthNmbSdW3gPElpsas9UK9N9t5eQwKBgFlkGfa55gJMskEeYXwtq2FH\n2EUTG0MM82dlLHD015bcpxSL146moYYjn0/q9uyysiqzWXDYy1udqZySo/L/s/qi\nDLZUIJP5r8JaFmjAIKwWE3+c90pyMkXS978Nh2u/wf6defy9pC1hisIozfmvCNPO\nXzn7V6NYd8LPB3gjQD7B\n-----END PRIVATE KEY-----\n
AUTH_JWT_PUBLIC_KEY=-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqzeWSrliFloYatzic5GA\nrrAtPl/RWgk1CUJWmvOkc8dpDNxZwl508BBspS0VwVYTioBuUUEruHGJgAk1pY6k\nbpu8L9F/QuqT86PaRrVrB2W9ckXMkXLYNGljYSuEGQ07T7Xa4ODh7q3YqkpqAq5P\nPDQEH49KX/H53TJEy/w/gSWuH21+VhxdAd9s54/mGAl5wRsDTsNff6xJdZzLAJe8\n4sq4zwjkaJe0shRCRAXI4FOj2dUfUjfKKP0H+AWKI+AMdD5QrmzTrDomyk3z4ew1\nIy4wAqmnb0CQDqPLSG/xvgmOy+jM3eV/FtcNlJr8jEn557iyAuK48ZU5hqwiqkpt\ncwIDAQAB\n-----END PUBLIC KEY-----\n  
AUTH_JWT_KID="auth-key-1755606439"
AUTH_JWT_ISSUER="nexus  -auth"
AUTH_JWT_AUDIENCE="nexus"
AUTH_JWT_ACCESS_EXPIRES_IN="30m"
AUTH_JWT_REFRESH_EXPIRES_IN="31d"

# Frontend URLs (comma-separated for CORS)
FRONTEND_URL="http://localhost:3000"
FRONTEND_URLS="http://localhost:3000,http://127.0.0.1:3000"

# Rate Limiting
RATE_LIMIT_MAX=100
RATE_LIMIT_WINDOW="15 minutes"

# Redis Configuration (REQUIRED for 10M+ users)
# Your Redis Cloud instance with database separation
REDIS_URL="redis://default:Z45okMQXWCkMn2aG6YwvvOmCZQGW2p2i@redis-15521.c11.us-east-1-2.ec2.redns.redis-cloud.com:15521/0"
REDIS_DISABLED=false

# Redis Cluster (production scale - 10M+ users)
REDIS_CLUSTER_NODES="redis-1:15521,redis-2:15521,redis-3:15521"
REDIS_PASSWORD="your-redis-cluster-password"

# Internal API Key (for cron jobs and internal services) - REQUIRED: 32+ chars
INTERNAL_API_KEY="ZvZv+KZey5nfeCRhfx8F3od54UoB6wbApUxfvui2PSaNnbRkCtpbRoc95ru2FT6V"

# Internal API Secret (for HMAC request signing) - REQUIRED: 64+ chars  
INTERNAL_API_SECRET="ZvZv+KZey5nfeCRhfx8F3od54UoB6wbApUxfvui2PSaNnbRkCtpbRoc95ru2FT6V"

# CSRF Secret (for CSRF token generation) - REQUIRED: 32+ chars
CSRF_SECRET="ZvZv+KZey5nfeCRhfx8F3od54UoB6wbApUxfvui2PSaNnbRkCtpbRoc95ru2FT6V"

# Enable request signing for internal APIs (optional, auto-enabled in production)
ENABLE_REQUEST_SIGNING="false"

# Application Settings
APP_NAME="Nexus"
EMAIL_FROM="Nexus <noreply@example.com>"
SUPPORT_EMAIL="support@example.com"

# Token Expiration
EMAIL_VERIFICATION_EXPIRES_IN="24h"
PASSWORD_RESET_EXPIRES_IN="1h"

# Cookies
# For localhost, leave COOKIE_DOMAIN unset to avoid invalid cookie domain issues.
# In production, set to your apex domain, e.g. .example.com

# Optional seed admin
# ADMIN_EMAIL="admin@example.com"
# ADMIN_PASSWORD="change_me_strong_password"
# ADMIN_DISPLAY_NAME="Head Admin"

# SMTP (leave SMTP_HOST empty to auto-use Ethereal in dev)
# https://ethereal.email/ provides a fake SMTP for previews
# When using a real SMTP, set the following:
SMTP_HOST="smtp.gmail.com"
SMTP_PORT=587
SMTP_SECURE="false"
SMTP_USER="hellojayanth98@gmail.com"
SMTP_PASS="rkck ewtm qwbs xzmo"
# Optional seed admin
# ADMIN_EMAIL="admin@example.com"
# ADMIN_PASSWORD="change_me_strong_password"
# ADMIN_DISPLAY_NAME="Head Admin"

# Service URLs for inter-service communication
PROFILE_SERVICE_URL="http://localhost:4002"

# Admin Security Configuration (CRITICAL - P0 Security Patches)
# Export encryption key - REQUIRED: 32+ characters
EXPORT_ENCRYPTION_KEY="ZvZv+KZey5nfeCRhfx8F3od54UoB6wbApUxfvui2PSaNnbRkCtpbRoc95ru2FT6V"

# MFA and confirmation timeouts
MFA_CHALLENGE_TIMEOUT_MINUTES=5
CONFIRMATION_TOKEN_TIMEOUT_MINUTES=10

# Bulk operation security limits
MAX_BULK_OPERATION_SIZE=100
MAX_BULK_OPERATIONS_PER_HOUR=10

# Admin session security
ADMIN_SESSION_TIMEOUT_MINUTES=30
ADMIN_RATE_LIMIT_MAX=50
ADMIN_RATE_LIMIT_WINDOW="15 minutes"
